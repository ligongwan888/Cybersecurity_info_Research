<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åæ³°ç½‘ç»œå®‰å…¨å®¢æˆ·ä¿¡æ¯æŸ¥è¯¢</title>
    <style>
        /* --- 1. å…¨å±€æ ·å¼å’Œæ•°å­—é›¨èƒŒæ™¯ --- */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden; /* é˜²æ­¢æ•°å­—é›¨æ»šåŠ¨æ¡ */
            background: #000;
            font-family: 'Consolas', monospace; /* ç¨‹åºå‘˜å­—ä½“ */
            color: #0F0;
        }
        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1; /* èƒŒæ™¯å±‚ */
        }
        /* --- 2. å®¹å™¨æ ·å¼ --- */
        #content-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10; /* å‰æ™¯å±‚ï¼Œé«˜äºèƒŒæ™¯ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* å‚ç›´å±…ä¸­ */
            text-shadow: 0 0 5px #0F0;
        }
        h1 {
            color: #0F0;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 0 0 10px #0F0, 0 0 20px #0F0; /* éœ“è™¹ç¯æ•ˆæœ */
        }
        /* --- 3. è¾“å…¥å’Œæœç´¢æ¡†æ ·å¼ --- */
        #search-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80%;
            max-width: 600px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7); /* åŠé€æ˜é»‘åº• */
            border: 1px solid #0F0;
            box-shadow: 0 0 10px #0F0;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        #name-input-group, #url-input-group, #file-upload-group {
            display: flex;
            width: 100%;
            margin-bottom: 15px;
        }
        input[type="text"], button {
            padding: 10px;
            border: 1px solid #0F0;
            font-size: 1em;
            background: rgba(0, 0, 0, 0.9);
            color: #0F0;
            font-family: 'Consolas', monospace;
            box-shadow: inset 0 0 5px #0F0;
        }
        input[type="text"] {
            flex-grow: 1;
            margin-right: 10px;
        }
        button {
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0F0;
            color: #000;
        }
        /* --- 4. ç»“æœå’Œä¿¡æ¯æ ·å¼ --- */
        #results-container {
            width: 80%;
            max-width: 600px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #0F0;
            box-shadow: 0 0 10px #0F0;
            border-radius: 5px;
            text-align: left;
        }
        .info-item {
            margin-bottom: 10px; 
            padding: 10px; 
            border-bottom: 1px dotted #0F0;
            word-wrap: break-word; /* å…è®¸åœ¨é•¿å•è¯å†…éƒ¨æ¢è¡Œ */
            white-space: normal;  /* ç¡®ä¿æ–‡æœ¬æ­£å¸¸æ¢è¡Œ */
        }
        .label { 
            font-weight: bold; 
            color: #00FF00; /* äº®ç»¿è‰² */
            display: inline-block; 
            width: 120px; 
            vertical-align: top;
        }
        .content {
            color: #FFF; /* ç™½è‰²å†…å®¹ */
        }
        a {
            color: #00FFFF; /* é“¾æ¥ä½¿ç”¨é’è‰² */
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        #loading {
            color: #FFD700; /* é»„é‡‘è‰² */
            font-weight: bold;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div id="content-container">
        <h1>åæ³°ç½‘ç»œå®‰å…¨å®¢æˆ·ä¿¡æ¯æŸ¥è¯¢ ğŸ›¡ï¸</h1>
        
        <div id="search-box">
            <div id="name-input-group">
                <input type="text" id="companyName" placeholder="ğŸ” è¯·è¾“å…¥å®¢æˆ·å…¬å¸åç§°" required>
                <button onclick="searchCompany()">æœç´¢</button>
            </div>

            <div id="url-input-group" style="display: none;">
                <input type="text" id="companyUrl" placeholder="è¾“å…¥ç½‘å€å‡†ç¡®æ€§æ›´é«˜ (å¯é€‰)" onfocus="this.placeholder=''" onblur="this.placeholder='è¾“å…¥ç½‘å€å‡†ç¡®æ€§æ›´é«˜ (å¯é€‰)'">
            </div>

            <div id="file-upload-group" style="display: none;">
                <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.png" style="width: 100%;">
            </div>
        </div>

        <div id="loading" style="display:none;">æ­£åœ¨è¿›è¡Œæ·±åº¦å®‰å…¨ä¿¡æ¯æ£€ç´¢...</div>

        <div id="results-container">
            <div id="results">
                </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // è®¾ç½® Canvas å¤§å°
        let W = canvas.width = window.innerWidth;
        let H = canvas.height = window.innerHeight;

        // çŸ©é˜µé›¨æ ¸å¿ƒé€»è¾‘
        let font_size = 12;
        let columns = Math.floor(W / font_size);
        let drops = [];
        for(let x=0; x<columns; x++) drops[x] = 1;

        const characters = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()';

        function draw() {
            // èƒŒæ™¯ï¼ŒåŠé€æ˜çš„é»‘ï¼Œç”¨äºåˆ¶é€ æ‹–å°¾æ•ˆæœ
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, W, H);
            
            ctx.fillStyle = '#0F0'; // ç»¿è‰²æ–‡å­—
            ctx.font = font_size + 'px Consolas';

            for(let i=0; i<drops.length; i++) {
                // éšæœºå­—ç¬¦
                let text = characters[Math.floor(Math.random() * characters.length)];
                
                // ç»˜åˆ¶å­—ç¬¦
                ctx.fillText(text, i * font_size, drops[i] * font_size);
                
                // è®©å­—ç¬¦æ»´è½
                if (drops[i] * font_size > H && Math.random() > 0.975) {
                    drops[i] = 0; // é‡ç½®åˆ°é¡¶éƒ¨
                }
                drops[i]++;
            }
        }
        
        window.onresize = function() {
            W = canvas.width = window.innerWidth;
            H = canvas.height = window.innerHeight;
            columns = Math.floor(W / font_size);
            drops = [];
            for(let x=0; x<columns; x++) drops[x] = 1;
        }

        setInterval(draw, 33); // æ¯ç§’30å¸§

        // --- API äº¤äº’ä»£ç  (æ²¿ç”¨æ—§é€»è¾‘) ---

        // æ›¿æ¢ä¸ºæ‚¨çš„ Render éƒ¨ç½²åœ°å€
        const API_BASE_URL = "https://cybersecurity-info-research.onrender.com/api/search"; 

        async function searchCompany() {
            const companyName = document.getElementById('companyName').value.trim();
            // æ³¨æ„ï¼šæˆ‘ä»¬ç°åœ¨åªä½¿ç”¨ companyNameï¼Œåé¢å†é›†æˆ companyUrl

            if (!companyName) {
                alert("è¯·è¾“å…¥å…¬å¸åç§°");
                return;
            }

            const resultsDiv = document.getElementById('results');
            const loadingDiv = document.getElementById('loading');
            
            resultsDiv.innerHTML = '';
            loadingDiv.style.display = 'block';

            try {
                // æ„é€  URLï¼Œä½¿ç”¨ companyName å’Œå¯é€‰çš„ companyUrl
                const url = `${API_BASE_URL}?name=${encodeURIComponent(companyName)}`;
                
                const response = await fetch(url);
                const data = await response.json();

                loadingDiv.style.display = 'none';

                if (data.error) {
                    resultsDiv.innerHTML = `<div style="color:#FF6347;">æœç´¢å¤±è´¥: ${data.error}</div><div style="font-size:0.8em; color:#FFD700;">${data.details || ''}</div>`;
                } else {
                    displayResults(data);
                }
            } catch (e) {
                loadingDiv.style.display = 'none';
                resultsDiv.innerHTML = `<div style="color:#FF6347;">è¿æ¥é”™è¯¯: æ— æ³•è¿æ¥åˆ°åç«¯æœåŠ¡ (${e.message})</div>`;
            }
        }

        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            
            // ç®€å•çš„ HTML ç»“æ„ç”Ÿæˆï¼Œç”¨äºå±•ç¤ºæå–åˆ°çš„ä¿¡æ¯
            resultsDiv.innerHTML = `
                <div class="info-item">
                    <span class="label">å…¬å¸åç§°:</span>
                    <span class="content">${data.company_name || 'æœªæ‰¾åˆ°'}</span>
                </div>
                <div class="info-item">
                    <span class="label">å®˜æ–¹ç½‘ç«™:</span> 
                    <span class="content">${data.website && data.website !== 'ä¿¡æ¯ä¸è¶³ï¼Œæ— æ³•ç¡®è®¤ã€‚' ? `<a href="http://${data.website}" target="_blank">${data.website}</a>` : data.website || 'æœªæ‰¾åˆ°'}</span>
                </div>
                <div class="info-item">
                    <span class="label">å¹´åº¦è¥æ”¶:</span> 
                    <span class="content">${data.revenue || 'æœªæ‰¾åˆ°'}</span>
                </div>
                <div class="info-item">
                    <span class="label">ä¸šåŠ¡èŒƒå›´:</span> 
                    <span class="content">${data.business || 'æœªæ‰¾åˆ°'}</span>
                </div>
                <div class="info-item">
                    <span class="label">å®‰å…¨äº‹ä»¶:</span> 
                    <span class="content">${data.security_incident || 'æœªæ‰¾åˆ°'}</span>
                </div>
            `;
        }
    </script>
</body>
</html>
